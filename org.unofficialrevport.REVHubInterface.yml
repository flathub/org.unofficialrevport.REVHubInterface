id: org.unofficialrevport.REVHubInterface
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
command: REVHubInterface.sh
finish-args:
  - --device=all
  - --share=ipc
  - --socket=x11
modules:
  - python3-requirements.json
  - name: tkinter
    buildsystem: simple
    build-commands:
      - pip3 install --prefix=${FLATPAK_DEST} .
    sources:
      - type: git
        url: https://github.com/iwalton3/tkinter-standalone
        commit: 88aa05075d90d393a29a484bce676e237d311082
    modules:
      - name: tcl
        buildsystem: autotools
        subdir: unix
        post-install:
          - chmod 755 /app/lib/libtcl*.so
        cleanup:
          - /bin
          - /lib/pkgconfig
          - /man
        sources:
          - type: archive
            url: https://prdownloads.sourceforge.net/tcl/tcl9.0.0-src.tar.gz
            sha256: 3bfda6dbaee8e9b1eeacc1511b4e18a07a91dff82d9954cdb9c729d8bca4bbb7
            x-checker-data:
              type: anitya
              project-id: 4941
              stable-only: true
              url-template: https://prdownloads.sourceforge.net/tcl/tcl$version-src.tar.gz
      - name: tk
        buildsystem: autotools
        subdir: unix
        post-install:
          - chmod 755 /app/lib/libtk*.so
        cleanup:
          - /bin
          - /lib/pkgconfig
          - /man
        sources:
          - type: archive
            url: https://prdownloads.sourceforge.net/tcl/tk9.0.0-src.tar.gz
            sha256: f166e3c20773c82243f753cef4b091d05267cb7f87da64be88cb2ca5a2ba027e
            x-checker-data:
              type: anitya
              project-id: 11426
              stable-only: true
              url-template: https://prdownloads.sourceforge.net/tcl/tk$version-src.tar.gz
  - name: revhubinterface
    buildsystem: simple
    build-commands:
      - python -m setuptools_scm --force-write-version-files
      - pip3 install --verbose --exists-action=i --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} . --no-build-isolation
      - install -Dm755 REVHubInterface.sh /app/bin/REVHubInterface.sh
      - install -Dm644 -t /app/share/applications flatpak/org.unofficialrevport.REVHubInterface.desktop
      - install -Dm644 -t /app/share/icons/hicolor/scalable/apps org.unofficialrevport.REVHubInterface.svg
      - install -Dm644 -t /app/share/metainfo org.unofficialrevport.REVHubInterface.metainfo.xml
    sources:
      - type: git
        url: https://github.com/unofficial-rev-port/REVHubInterface.git
        commit: ff2966db90efe3f6e46e748f0cdf0680dacb66f8
        disable-shallow-clone: true


